<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!--不使用IE兼容模式（杂项）-->
    <meta name="renderer" content="webkit"><!--默认使用极速模式，目前只有360支持，不过已经够了-->
    <meta name="viewport" content="width=device-width, initial-scale=1"><!--平板或视网膜屏100%缩放显示网页-->
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    <link rel="icon" href="favicon.ico"><!--客户有需要时添加，ico图标-->
    <title>我的云联惠ID</title>
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="css/lucky.css">
    <link rel="stylesheet" type="text/css" href="css/jonas.css">
    <link rel="stylesheet" type="text/css" href="css/laughing.css">

    <script src="js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
</head>
<body>
<div class="header-1 black-bg">
    <div class="container header-cont-1 clearfix">
        <span class="inline-block left">您好，欢迎光临云蚨商城！</span>
        <div class="right">
            <a href="my-center.html" class="header-link-2">我的云蚨</a>
            <a href="order.html" class="header-link-2">我的订单</a>
            <div class="inline-block relative header-box">
                <a href="my-center.html" class="header-link-3">帮助中心</a>
                <ul class="abs header-list">
                    <li><a href="help-center.html">帮助中心</a></li>
                    <li><a href="return-service.html">返修/退换货</a></li>
                    <li><a href="complain-center.html">投诉中心</a></li>
                    <li><a href="advice-center.html">意见和建议</a></li>
                    <li><a href="make-appointment.html">预约</a></li>
                    <li><a href="customer-call.html">电话客服/在线客服</a></li>
                </ul>
            </div>
            <a href="javascript:void(0)" class="header-link-4" onclick="addFavorite()"><i class="star-icon"></i>收藏本站</a>
            <a href="customer-call.html" class="header-link-4"><i class="call-icon"></i>联系客服</a>
        </div>
    </div>
</div>
<div class="header-2 black-bg">
    <div class="container clearfix">
        <div class="left">
            <img src="images/lucky-img/logo.png">
        </div>
        <div class="right">
            <img src="images/lucky-img/head-phone-white.png">
        </div>
    </div>
</div>
<div class="nav-bar">
    <div class="container nav-bar-box">
        <a href="index.html">首页</a>
        <a href="shopping-car.html">购物车</a>
        <a href="my-center.html" class="active">个人中心</a>
    </div>
</div>
<div class="container j-quitAgent clearfix">
    <div class="j-sidebar left">
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>个人账户信息</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="my-data.html">个人资料</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="account-safe.html">账户安全</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="#">消息订阅</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="#">个人交易信息</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-address.html" class="active">收货地址</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>订单中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="order.html">全部订单</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>关注中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="order.html">全部关注</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>资产中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="my-wallet.html">我的钱包</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-points.html">我的积分</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-award.html">我的奖励</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-oilCar.html">我的油卡</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-agreement.html">我的协议</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>代理中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="quit-agent.html">退代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="agent-center.html">申请区域代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="transfer-agent.html">转让代理权</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-recommend.html">我推荐的人</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>会员中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="apply-agent.html">申请代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="recommend-vip.html">推荐会员</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="apply-vip.html">推荐代理</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>客服中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="make-appointment.html">预约</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="complain-center.html">投诉中心</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="advice-center.html">意见和建议</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="return-service.html">返修/退换货</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="customer-call.html">电话客服/在线客服</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="help-center.html">帮助中心</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="j-content right">
        <div class="j-content-title">
            云联ID卡
            <a href="javascript:void(0)" class="right add-address">新增云联ID卡</a>
        </div>
        <div class="j-agentCenter-content address-content address-content-kb clearfix">
            <!-- <div class="ylh-add-container clearfix">
                <div class="ylh-add-item ">
                    <div class="ylh-add-label">姓名:</div>
                    <div class="ylh-add-info">{{name}}</div>
                </div>
                <div class="ylh-add-item">
                    <div class="ylh-add-label">身份证号码:</div>
                    <div class="ylh-add-info">441481199410052713</div>
                </div>
                <div class="ylh-add-item">
                    <div class="ylh-add-label">云联惠ID:</div>
                    <div class="ylh-add-info">{{name}}</div>
                </div>
                <div class="ylh-add-item">
                    <div class="ylh-add-label">注册手机号码:</div>
                    <div class="ylh-add-info">{{name}}</div>
                </div>
            </div> -->

        </div>

    </div>
</div>
<footer class="j-login-footer">
    <div class="container clearfix">
        <div class="j-login-foot-1">
            <a href="#">关于我们</a>
            <a href="#">售后服务</a>
            <a href="#">联系我们</a>
            <a href="#">免责声明</a>
            <a href="#">法律声明</a>
        </div>
        <div class="j-login-foot-2">
            <span>电话：400-608-9488</span>
            <span>传真：020-87247609</span> 
            <span>E-MAIL：info@goodthree.com</span>     
            <span>广州市白云区同和街道1128号老庄村君誉商务中心一楼</span>
        </div>
        <div class="j-login-foot-3">
            <p>Copyright 2016 2017 广东云蚨贸易有限公司   粤A2-20044005号 粤ICP备15045834号-2</p>
        </div>
    </div>
</footer>

<script type="text/template7" id="temp1">
    <!-- {{#each address}}
    <div class="address-item left {{#if active}}active{{/if}}" data-id="{{id}}">
        <div class="address-top">
            <span class="address-prov">{{prov}}{{city}}</span>
            <span class="address-person">（<i class="address-name">{{person}}</i>收）</span>
        </div>
        <div class="address-middle">
            <span class="address-location">{{dist}}{{location}}</span>
            <span class="address-phone">{{phone}}</span>
        </div>
        <div class="address-bottom">
            {{#unless active}}
                <a href="javascript:void(0)" class="address-btn set-defalut">设为默认</a>
            {{/unless}}
            <a href="javascript:void(0)" class="address-btn edit-address">编辑</a>
            <a href="javascript:void(0)" class="address-btn del-address">删除</a>
        </div>
    </div>
    {{/each}} -->
    {{#each address}}
        <div class="ylh-add-container clearfix" data-id="">
            <div><span class="ylh-item-closed">x</span></div>
            <div class="ylh-add-item ">
                <div class="ylh-add-label">姓名:</div>
                <div class="ylh-add-info">{{name}}</div>
            </div>
            <div class="ylh-add-item">
                <div class="ylh-add-label">身份证号码:</div>
                <div class="ylh-add-info">{{certificate}}</div>
            </div>
            <div class="ylh-add-item">
                <div class="ylh-add-label">云联惠ID:</div>
                <div class="ylh-add-info">{{云联惠ID}}</div>
            </div>
            <div class="ylh-add-item">
                <div class="ylh-add-label">注册手机号码:</div>
                <div class="ylh-add-info">{{phone}}</div>
            </div>
        </div>  
    {{/each}}
</script>

<script type="text/template7" id="temp2">
    <form class="j-addCard-form address-form" id="ylhid-form">
        <input type="hidden" name="" class="address-hidden" value="{{id}}">
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>姓名：</label>
            <input type="text" value="{{person}}" class="j-agentCenter-input" name="person">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>身份证号码：</label>
            <input type="text" value="{{certificate}}" class="j-agentCenter-input" name="certificate">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>云联惠ID：</label>
            <input type="text" value="{{云联惠ID}}" class="j-agentCenter-input" name="云联惠ID">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title">注册手机号码：</label>
            <input type="text" value="{{phone}}" class="j-agentCenter-input" name="phone">
        </div>
        <div class="j-findBack-btn">
            <button type="submit" class="btn">添加</button>
        </div>
    </form>
</script>
<script type="text/javascript" src="js/jquery.validate.min.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/jquery.cityselect.js"></script>
<script type="text/javascript" src="js/selectCity.js"></script>
<script type="text/javascript" src="libs/template7/template7.min.js"></script>
<script type="text/javascript">
(function(){
    //控制侧边栏
    var Otitle = $('.j-sidebar-title').get();
    var list = $('.j-sidebar-list').get();

    for( var i=0;i<Otitle.length;i++ ){

        Otitle[i].index = i;
        Otitle[i].onOff = true;

        Otitle[i].onclick = function(){
            if(this.onOff){
                $(this).find('span').addClass('j-minus')
            }else{
                $(this).find('span').removeClass('j-minus')
            }
            
            $(list[this.index]).slideToggle();

            this.onOff = !this.onOff;
        }

    }    
})();

var data1 = {
    address:[{
        id:"1",
        "name":"小明",
        "certificate":"4654564645464546456",
        "云联惠ID":"越秀区",
        "phone":"13560185678",
        "active":true
    },{
        id:"2",
        "name":"小明",
        "certificate":"4654564645464546456",
        "云联惠ID":"越秀区",
        "phone":"13560185678",
        "active":false
    }]
}
var tmpl1 = $('#temp1').html(),
    compiledTemplate = Template7.compile(tmpl1),
    //把数据打包丢进模板
    tempHtml1 = compiledTemplate(data1);
    $(".address-content").html(tempHtml1);

$(function(){
    

    $(".set-defalut").on("click",function(){//设置默认
        var dataId = $(this).parents(".address-item").attr("data-id");
        console.log(dataId);
        // $.ajax({
        //     url: '/path/to/file',
        //     type: 'POST',
        //     dataType: 'json',
        //     data: {
        //         "id": dataId,
        //     },
        //     success:function(data){
        //         layer.msg("设置默认地址成功！",{
        //             time:800
        //         })
        //     }
        // })
        
    })

    /*$(".edit-address").on("click",function(){//编辑
        var dataId = $(this).parents(".address-item").attr("data-id");
        var data2 = {
            "id":"1",
            "prov":"广东",
            "city":"广州",
            "dist":"越秀区",
            "address":"东风东路761号丽丰中心7楼讯猫软件",
            "phone":"13560185678",
            "person":"陈小明",
            "email":"4578454545@qq.com",
        };
        var tmpl2 = $('#temp2').html(),
        compiledTemplate = Template7.compile(tmpl2),
        //把数据打包丢进模板
        tempHtml2 = compiledTemplate(data2);
        layer.open({
            type:'1',
            title:"新增",
            area: '600px',//宽度
            content:tempHtml2,
            success:function(){
                $("#citySelect").citySelect({  
                   nodata: "none", //隐藏无数据的子级select 
                   prov:data2.prov,
                   city:data2.city,
                   dist:data2.dist
                });
                validate();
            }
        })
    })
*/

    $(".add-address").on("click",function(){//新增
        var data3 = {
            "id":"",
            "prov":"",
            "city":"",
            "dist":"",
            "address":"",
            "phone":"",
            "person":"",
            "email":"",
        };
        var tmpl2 = $('#temp2').html(),
        compiledTemplate = Template7.compile(tmpl2),
        //把数据打包丢进模板
        tempHtml2 = compiledTemplate(data3);
        layer.open({
            type:'1',
            title:"添加云联惠ID",
            area: '600px',//宽度
            content:tempHtml2,
            success:function(){
                validate();
                // 写ajax事件
            }
        })
    })

    $(".ylh-item-closed").on("click",function(){//删除
        var div = $(this).parents(".ylh-add-container");
        var dataId = div.attr("data-id");

        layer.confirm('您确定要删除云联ID卡？', {
            title:'删除云联ID卡',
            btn: ['确定', '取消' ],
            yes:function(index, layero){
                // $.ajax({
                //     url: '/path/to/file',
                //     type: 'POST',
                //     dataType: 'json',
                //     data: {
                //         "id": dataId,
                //     },
                //     success:function(data){
                //         layer.msg("删除地址成功！",{
                //             time:800
                //         })
                //          div.remove();
                //     }
                // })
            },
            btn2:function(index, layero){
                layer.close(index);
            }
        })

    })
})

//增加身份证验证
function isIdCardNo(num) {
    var factorArr = new Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2, 1);
    var parityBit = new Array("1", "0", "X", "9", "8", "7", "6", "5", "4", "3", "2");
    var varArray = new Array();
    var intValue;
    var lngProduct = 0;
    var intCheckDigit;
    var intStrLen = num.length;
    var idNumber = num;
    // initialize
    if ((intStrLen != 15) && (intStrLen != 18)) {
        return false;
    }
    // check and set value
    for (i = 0; i < intStrLen; i++) {
        varArray[i] = idNumber.charAt(i);
        if ((varArray[i] < '0' || varArray[i] > '9') && (i != 17)) {
            return false;
        } else if (i < 17) {
            varArray[i] = varArray[i] * factorArr[i];
        }
    }
    if (intStrLen == 18) {
        //check date
        var date8 = idNumber.substring(6, 14);
        if (isDate8(date8) == false) {
            return false;
        }
        // calculate the sum of the products
        for (i = 0; i < 17; i++) {
            lngProduct = lngProduct + varArray[i];
        }
        // calculate the check digit
        intCheckDigit = parityBit[lngProduct % 11];
        // check last digit
        if (varArray[17] != intCheckDigit) {
            return false;
        }
    }
    else {        //length is 15
        //check date
        var date6 = idNumber.substring(6, 12);
        if (isDate6(date6) == false) {
            return false;
        }
    }
    return true;
}
function isDate6(sDate) {
    if (!/^[0-9]{6}$/.test(sDate)) {
        return false;
    }
    var year, month, day;
    year = sDate.substring(0, 4);
    month = sDate.substring(4, 6);
    if (year < 1700 || year > 2500) return false
    if (month < 1 || month > 12) return false
    return true
}

function isDate8(sDate) {
    if (!/^[0-9]{8}$/.test(sDate)) {
        return false;
    }
    var year, month, day;
    year = sDate.substring(0, 4);
    month = sDate.substring(4, 6);
    day = sDate.substring(6, 8);
    var iaMonthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]
    if (year < 1700 || year > 2500) return false
    if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) iaMonthDays[1] = 29;
    if (month < 1 || month > 12) return false
    if (day < 1 || day > iaMonthDays[month - 1]) return false
    return true
}
// 身份证号码验证end

function validate(){
    jQuery.validator.addMethod("isPhone",function(value,element){
    var length = value.length;
    var mobile = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/;
        return this.optional(element) || (mobile.test(value));
    },"请填写正确的手机号码");
    jQuery.validator.addMethod("isChinese",function(value,element){
    var length = value.length;
    var mobile = /^[a-zA-Z]|[\u4e00-\u9fa5]+$/;
        return this.optional(element) || (mobile.test(value));
    },"请填写中文");
    // 身份证号码验证
    jQuery.validator.addMethod("isIdCardNo", function (value, element) {
        return this.optional(element) || isIdCardNo(value);
    }, "请正确输入您的身份证号码");
    jQuery.validator.addMethod("stringCheck", function(value, element){
        var reg = /^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$/;
        return this.optional(element) || reg.test(value);    
    }, "只包括中文字、英文字母、数字和下划线,不能以下划线开头结尾");
    jQuery.validator.addMethod("stringCheck2", function(value, element){
    var reg = /^[a-zA-Z0-9_\u4e00-\u9fa5]+$/;
    return this.optional(element) || reg.test(value);    
    }, "不能输入特殊字符");
    //只能输入中英文
    jQuery.validator.addMethod("trueName", function(value, element){
    var reg = /^[\u0391-\uFFE5A-Za-z]+$/;
    return this.optional(element) || reg.test(value);    
    }, "名字只能为中英文");

    var $form1 = $(".address-form");
    /* 表单验证 */
    $form1.validate({
        rules: {
            'person': {
                required: true,
                maxlength:15,
                minlength:2,
                trueName:true,
                stringCheck2:true
            },
            'certificate': {
                required: true,
                isIdCardNo:true
            },
            '云联惠ID': {
                required: true,
                maxlength:16,
                minlength:2,
                stringCheck2:true
            },
            'phone': {
                required: true,
                isPhone:true

            },
            'email':{
                email:true
            }

        },
        messages: {
            'person': {
                required:"此项为必填项",
                maxlength:"输入字符不能超过13位"
            },
            'certificate': {
                required:"此项为必填项",
            },
            '云联惠ID': {
                required:"此项为必填项",
                maxlength:"输入字符不能超过13位"
            },
            'phone': {
                required:"此项为必填项",
            },
            'email':{
                email:"请输入正确的邮箱格式",
            }
        },
        highlight:function(e){
            $(e).parent().addClass('j-wranning');
        }
    });
}
</script>
</body>
</html>