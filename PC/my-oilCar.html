<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!--不使用IE兼容模式（杂项）-->
    <meta name="renderer" content="webkit"><!--默认使用极速模式，目前只有360支持，不过已经够了-->
    <meta name="viewport" content="width=device-width, initial-scale=1"><!--平板或视网膜屏100%缩放显示网页-->
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    <link rel="icon" href="favicon.ico"><!--客户有需要时添加，ico图标-->
    <title>我的油卡</title>
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="css/lucky.css">
    <link rel="stylesheet" type="text/css" href="css/jonas.css">
    <link rel="stylesheet" type="text/css" href="css/laughing.css">
    <script src="js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
</head>
<body>
<div class="header-1 black-bg">
    <div class="container header-cont-1 clearfix">
        <span class="inline-block left">您好，欢迎光临云蚨商城！</span>
        <div class="right">
            <a href="my-center.html" class="header-link-2">我的云蚨</a>
            <a href="order.html" class="header-link-2">我的订单</a>
            <div class="inline-block relative header-box">
                <a href="my-center.html" class="header-link-3">帮助中心</a>
                <ul class="abs header-list">
                    <li><a href="help-center.html">帮助中心</a></li>
                    <li><a href="return-service.html">返修/退换货</a></li>
                    <li><a href="complain-center.html">投诉中心</a></li>
                    <li><a href="advice-center.html">意见和建议</a></li>
                    <li><a href="make-appointment.html">预约</a></li>
                    <li><a href="customer-call.html">电话客服/在线客服</a></li>
                </ul>
            </div>
            <a href="javascript:void(0)" class="header-link-4" onclick="addFavorite()"><i class="star-icon"></i>收藏本站</a>
            <a href="customer-call.html" class="header-link-4"><i class="call-icon"></i>联系客服</a>
        </div>
    </div>
</div>
<div class="header-2 black-bg">
    <div class="container clearfix">
        <div class="left">
            <img src="images/lucky-img/logo.png">
        </div>
        <div class="right">
            <img src="images/lucky-img/head-phone-white.png">
        </div>
    </div>
</div>
<div class="nav-bar">
    <div class="container nav-bar-box">
        <a href="index.html">首页</a>
        <a href="shopping-car.html">购物车</a>
        <a href="my-center.html">个人中心</a>
    </div>
</div>
<div class="container j-quitAgent clearfix">
    <div class="j-sidebar left">
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>个人账户信息</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="my-data.html">个人资料</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="account-safe.html">账户安全</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="#">消息订阅</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="#">个人交易信息</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-address.html">收货地址</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>订单中心</p>
            </div>
            <ul class="j-sidebar-list none">
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>关注中心</p>
            </div>
            <ul class="j-sidebar-list none">
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>资产中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="my-wallet.html">我的钱包</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-points.html" class="active">我的积分</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-award.html">我的奖励</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-oilCar.html">我的油卡</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-agreement.html">我的协议</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>代理中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="quit-agent.html">退代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="agent-center.html">申请区域代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="transfer-agent.html">转让代理权</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="my-recommend.html">我推荐的人</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>会员中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="apply-agent.html">申请代理</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="recommend-vip.html">推荐会员</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="apply-vip.html">推荐代理</a>
                </li>
            </ul>
        </div>
        <div class="j-sidebar-wrap">
            <div class="j-sidebar-title">
                <span></span>
                <p>客服中心</p>
            </div>
            <ul class="j-sidebar-list none">
                <li class="j-sidebar-item">
                    <a href="make-appointment.html">预约</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="complain-center.html">投诉中心</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="advice-center.html">意见和建议</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="return-service.html">返修/退换货</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="customer-call.html">电话客服/在线客服</a>
                </li>
                <li class="j-sidebar-item">
                    <a href="help-center.html">帮助中心</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="j-content right">
        <div class="j-content-title clearfix">
            我的油卡
            <form id="oil-search" class="right">
            <div class="search-div clearfix right   ">   
                <input type="text" placeholder="搜索">
                <span id="search-btn"><img src="" alt=""><img src="images/laughing-img/search.png" alt="搜索"></span>
            </div>
            
        </form>
        </div>
        <div class="j-myAward-content">
            <div class="j-myRecommend-tab">
                <span class="active">我的油卡</span>
                <span>挂失</span>
                <span>失效卡补卡</span>
                <span>查看油卡密码</span>
            </div>
            <div class="j-myAward-wrap">
                <ul class="j-myAward-list clearfix">
                    <li class="j-myAward-item left">
                        <div class="j-myAward-img">
                            <img src="images/jonas-img/j-oil.png" alt="">
                            <div class="j-myAward-text">
                                <p class="j-myAward-title"><span>我的油卡号</span><span>1256894</span></p>
                                <ul class="j-myAward-kind clearfix">
                                    <li class="left">品牌：<span>中石油</span></li>
                                    <li class="left">油品：<span>汽油</span></li>
                                    <li class="left">地区：<span>全国</span></li>
                                    <li class="left">卡种：<span>中石油卡</span></li>
                                    <li class="left">使用人：<span>取消消</span></li>
                                    <li class="left">卡主：<span>小小明</span></li>
                                </ul>
                            </div>
                        </div>
                        <div class="j-myAward-a">
                            <a href="#">使用人</a>
                            <a href="#">更换卡主</a>
                            <a href="oilCar-recharge.html">充值</a>
                            <a href="javascript:;" class="j-change">换卡</a>
                        </div>
                    </li>
                    <li class="j-myAward-item left">
                        <div class="j-myAward-img">
                            <img src="images/jonas-img/j-oil.png" alt="">
                            <div class="j-myAward-text">
                                <p class="j-myAward-title"><span>我的油卡号</span><span>1256894</span></p>
                                <ul class="j-myAward-kind clearfix">
                                    <li class="left">品牌：<span>中石油</span></li>
                                    <li class="left">油品：<span>汽油</span></li>
                                    <li class="left">地区：<span>全国</span></li>
                                    <li class="left">卡种：<span>中石油卡</span></li>
                                    <li class="left">使用人：<span>取消消</span></li>
                                    <li class="left">卡主：<span>小小明</span></li>
                                </ul>
                            </div>
                        </div>
                        <div class="j-myAward-a">
                            <a href="#">使用人</a>
                            <a href="#">更换卡主</a>
                            <a href="oilCar-recharge.html">充值</a>
                            <a href="javascript:;" class="j-change">换卡</a>
                        </div>
                    </li>
                    <li class="j-myAward-item left j-oilAdd">
                        <div class="j-myAward-img">
                            添加油卡
                        </div>
                    </li>
                </ul>
                <div class="j-myOilCard-wrap">
                    <p>流水记录</p>
                    <table class="j-myRecommend-table">
                        <thead>
                            <tr>
                                <th>时间</th>
                                <th>充值油卡</th>
                                <th>备注</th>
                            </tr>
                        </head>
                        <tbody>
                            <tr>
                                <td>2016-09-20  14:55:20</td>
                                <td>100.00</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>2016-09-20  14:55:20</td>
                                <td>100.00</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="page-box">
                        <div id="laypage"></div>
                    </div>
                </div>
            </div>
            <div class="j-myAward-wrap j-myAward-wrap2 none"></div>
            <div class="j-myAward-wrap j-myAward-wrap3 none">5555</div>
            <div class="j-myAward-wrap j-myAward-wrap4 none">
                <div class="look-password-item">
                    <div class="look-item-card">油卡编号：121416545645645</div>
                    <div class="look-item-password">圈存密码：244566556</div>
                    
                </div>
                <div class="look-password-item">
                    <div class="look-item-card">油卡编号：121416545645645</div>
                    <div class="look-item-password">圈存密码：244566556</div>
                    
                </div>
                <div class="look-password-item">
                    <div class="look-item-card">油卡编号：121416545645645</div>
                    <div class="look-item-password">圈存密码：244566556</div>
                    
                </div>
                <div id="laypage" class="oilcard-layerpage">分页</div>
            </div>
        </div>
    </div>
</div>
<footer class="j-login-footer">
    <div class="container clearfix">
        <div class="j-login-foot-1">
            <a href="#">关于我们</a>
            <a href="#">售后服务</a>
            <a href="#">联系我们</a>
            <a href="#">免责声明</a>
            <a href="#">法律声明</a>
        </div>
        <div class="j-login-foot-2">
            <span>电话：400-608-9488</span>
            <span>传真：020-87247609</span> 
            <span>E-MAIL：info@goodthree.com</span>     
            <span>广州市白云区同和街道1128号老庄村君誉商务中心一楼</span>
        </div>
        <div class="j-login-foot-3">
            <p>Copyright 2016 2017 广东云蚨贸易有限公司   粤A2-20044005号 粤ICP备15045834号-2</p>
        </div>
    </div>
</footer>
<script type="text/javascript" src="js/swiper.min.js"></script>
<script type="text/javascript" src="js/jquery.validate.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/laypage/laypage.js"></script>
<script type="text/javascript" src="libs/template7/template7.min.js"></script>

<script id="template" type="text/template7">
    {{#if type}}
    <form class="j-addCard-form {{#if warning}}j-oilCar-form1{{/if}} {{#if number}}j-oilCar-form3{{/if}}">
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{name.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{name.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{idcard.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{idcard.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{iphone.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{iphone.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{oilcard.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{oilcard.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{why.text}}</label>
            <textarea name="" id="" class="j-complain-sel j-complain-textarea" >
                
            </textarea>
            <!-- <input type="text" value="" class="j-agentCenter-input" name="{{why.name}}"> -->
        </div>
        {{#if warning}}
            <p class="j-oilCar-warming">仅支持个人实名卡，暂不支持单位卡，司机卡等其他类型卡</p>
        {{/if}}
        <div class="j-findBack-btn">
            <button class="j-findBack-submit">保存</button>
        </div>
    </form>
    {{else}}
    <form class="j-addCard-form j-oilCar-form2">
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{idnumber.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{idnumber.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{connect.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{connect.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{address.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{address.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{oilnumber.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{oilnumber.name}}">
        </div>
        <div class="j-agentCenter-row2 clearfix">
            <label class="left j-agentCenter-title"><span class="j-red">*</span>{{why.text}}</label>
            <input type="text" value="" class="j-agentCenter-input" name="{{why.name}}">
        </div>
        <div class="j-findBack-btn">
            <button class="j-findBack-submit">保存</button>
        </div>
    </form>
    {{/if}}
</script>

<script type="text/javascript">
(function(){
    //控制侧边栏
    var Otitle = $('.j-sidebar-title').get();
    var list = $('.j-sidebar-list').get();

    for( var i=0;i<Otitle.length;i++ ){

        Otitle[i].index = i;
        Otitle[i].onOff = true;

        Otitle[i].onclick = function(){
            if(this.onOff){
                $(this).find('span').addClass('j-minus')
            }else{
                $(this).find('span').removeClass('j-minus')
            }
            
            $(list[this.index]).slideToggle();

            this.onOff = !this.onOff;
        }
    }
})();

(function(){
    //tab侧边栏切换
    var Otab = $('.j-myRecommend-tab').find('span').get();
    var Owrap = $('.j-myAward-wrap').get();

    for( var i=0;i<Otab.length;i++ ){

        Otab[i].index = i;

        Otab[i].onclick = function(){
            for( var j=0;j<Otab.length;j++ ){
                $(Otab[j]).removeClass('active');
                $(Owrap[j]).addClass('none')
            }
            $(this).addClass('active');
            $(Owrap[this.index]).removeClass('none');
        }

    };

})();

(function(){
    //弹出层

        /*添加油卡数据*/
    var datas = {
            'name':{
                'name':'name',
                'text':'姓名：'
            },
            'idcard':{
                'name':'idcard',
                'text':'身份证号：'
            },
            'iphone':{
                'name':'iphone',
                'text':'手机号码：'
            },
            'oilcard':{
                'name':'oilcard',
                'text':'油卡号：'
            },
            'why':{
                'name':'why',
                'text':' 原因：'
            },           
            'warning':true,
            'type':true,
            'number':false
        },

        /*换卡数据*/
        datas2 = {
            'idnumber':{
                'name':'idnumber',
                'text':'卡号：'
            },
            'connect':{
                'name':'connect',
                'text':'联系人：'
            },
            'address':{
                'name':'address',
                'text':'换卡地址：'
            },
            'oilnumber':{
                'name':'oilnumber',
                'text':'油卡号：'
            },
            'why':{
                'name':'why',
                'text':' 原因：'
            },
            'warning':false,
            'type':false,
            'number':false
        },

        /*挂失数据*/
        datas3 = {
            'name':{
                'name':'name',
                'text':'姓名：'
            },
            'idcard':{
                'name':'idcard',
                'text':'身份证号：'
            },
            'iphone':{
                'name':'iphone',
                'text':'手机号码：'
            },
            'oilcard':{
                'name':'oilcard',
                'text':'油卡号：'
            },
            'why':{
                'name':'why',
                'text':' 原因：'
            }, 
            'warning':false,
            'type':true,
            'number':true
        };

    var tmpl = $('#template').html(),
        compiledTemplate = Template7.compile(tmpl),
        //把数据打包丢进模板
        tempHtml = compiledTemplate(datas),
        tempHtml2 = compiledTemplate(datas2),
        tempHtml3 = compiledTemplate(datas3);

    var $add = $('.j-oilAdd').find('.j-myAward-img');
    var $change = $('.j-change');
    var $wrap = $('.j-myAward-wrap2');

    $wrap.html(tempHtml3);

    val();

    $add.click(function(){
        popup = layer.open({
            type:'1',
            title:"新增油卡",
            area: ['600px'],
            content:tempHtml,
            fixed:true,
            success:function(){
                val();
            }
        });
    });

    $change.click(function(){
        popup = layer.open({
            type:'1',
            title:"换卡",
            area: ['600px'],
            content:tempHtml2,
            fixed:true,
            success:function(){
                val();
            }
        });
    });

    /*表单验证*/
    function val(){
        jQuery.validator.addMethod("isPhone",function(value,element){
        var length = value.length;
        var mobile = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/;
            return this.optional(element) || (mobile.test(value));
        },"请填写正确的手机号码");
        jQuery.validator.addMethod("isChinese",function(value,element){
        var length = value.length;
        var mobile = /^[a-zA-Z]|[\u4e00-\u9fa5]+$/;
            return this.optional(element) || (mobile.test(value));
        },"请填写中文");
        var $form1 = $(".j-oilCar-form1");
        var $form2 = $(".j-oilCar-form2");
        var $form3 = $(".j-oilCar-form3");

        console.log($form1)
        /* 表单验证 */
        $form1.validate({
            rules: {
                'name': {
                    required: true
                },
                'idcard': {
                    required: true
                },
                'iphone': {
                    required: true
                },
                'oilcard': {
                    required: true
                }

            },
            messages: {
                'name': {
                    required:'请输入姓名'
                },
                'idcard': {
                    required:'请输入身份证号'
                },
                'iphone': {
                    required:'请输入手机号码'
                },
                'oilcard': {
                    required:'请输入油卡号'
                }
            },
            highlight:function(e){
                $(e).parent().addClass('j-wranning');
            }
        });

        $form2.validate({
            rules: {
                'idnumber': {
                    required: true
                },
                'connect': {
                    required: true
                },
                'address': {
                    required: true
                },
                'oilnumber': {
                    required: true
                },
                'why': {
                    required: true
                }

            },
            messages: {
                'idnumber': {
                    required:'请输入卡号'
                },
                'connect': {
                    required:'请输入联系人'
                },
                'address': {
                    required:'请输入换卡地址'
                },
                'oilnumber': {
                    required:'请输入油卡号'
                },
                'why': {
                    required:'请输入原因'
                }
            },
            highlight:function(e){
                $(e).parent().addClass('j-wranning');
            }
        });

        $form3.validate({
            rules: {
                'name': {
                    required: true
                },
                'idcard': {
                    required: true
                },
                'iphone': {
                    required: true
                },
                'oilcard': {
                    required: true
                }

            },
            messages: {
                'name': {
                    required:'请输入姓名'
                },
                'idcard': {
                    required:'请输入身份证号'
                },
                'iphone': {
                    required:'请输入手机号码'
                },
                'oilcard': {
                    required:'请输入油卡号'
                }
            },
            highlight:function(e){
                $(e).parent().addClass('j-wranning');
            }
        });
    }

})();

$(function(){
    function page(curr){
        $(".j-myRecommend-table tbody").html("");
        $.ajax({
            url:'${ctx}/front/oilCard/myOilCardlode',
            data:{
                pageNo:curr || 1,
                pageSize:5,
            },
            success:function(data){
                console.log(data);
                var list = data.result.resultList;
                var pageNo = data.result.pageNo;
                var count = data.result.pageCount;
                $.each(list,function(index){
                    var time = list[index].addTime;
                    var money = list[index].charge;
                    var comments = list[index].comments;
                    $(".j-myRecommend-table tbody").append('<tr><td>'+time+'</td><td>'+money+'</td><td>'+comments+'</td></tr>');
                })
                laypage({
                    cont: 'laypage',
                    pages: count,//总页数
                    curr: pageNo,//当前页
                    groups: 5,//连续显示分页数
                    jump:function(obj, first){
                        if(!first){ //点击跳页触发函数自身，并传递当前页：obj.curr
                            page(obj.curr);
                        }                     
                        
                    }
                });
            }
        })
        
    }
    page();
})

// laughing
$(function(){

})
</script>
</body>
</html>